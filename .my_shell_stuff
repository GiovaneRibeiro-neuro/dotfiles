#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
#!!!!!!!! DO NOT EDIT THIS FILE !!!!!!!!
#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
#
# Please create a file called ~/.my_shell_complements and put your 
# speficic aliases/exports/functions/whatever there. Let's 
# keep this file essential!
#
# .my_shell_stuff - sh-common extension to add functionalities specific per-OS, and depends of another frameworks/applications 

# Permite a extração do Dockerfile de uma determinada imagem
# exemplo de uso: dfimage -sV=1.36 nginx:latest
test alias dfimage > /dev/null 2>&1 || alias dfimage="docker run -v /var/run/docker.sock:/var/run/docker.sock --rm alpine/dfimage -sV=1.36"

##
# FUNCTIONS/APPS
##

aws-login() {

    if ! which aws &>/dev/null; then
	    curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "/tmp/awscliv2.zip"
	    cd /tmp
	    unzip awscliv2.zip
	    sudo ./aws/install
	    cd $HOME
    fi
    
    SSO_SESSION_NAME=""
    [ -z ${AWS_SSO_SESSION_NAME+x} ] || SSO_SESSION_NAME="--sso-session $AWS_SSO_SESSION_NAME"

    PROFILE=default
    [ -n "$1" ] && PROFILE=$1

    if command -v aws >/dev/null 2>&1
    then
        aws sts get-caller-identity &> /dev/null
        EXIT_CODE="$?"
        if [ $EXIT_CODE != 0 ]; then
            aws sso login $SSO_SESSION_NAME
        fi

        aws configure export-credentials --profile $PROFILE --format env-no-export
    fi

}

##
# EXPORTS
##

# General exports
export NODE_ENV="development"
export PATH="$HOME/.cargo/bin:$PATH"
export EDITOR=vim
export TMPDIR=/tmp

##
# ALIAS
##
test alias info >/dev/null 2>&1 || alias info='informant --file $HOME/.cache/informant.dat'

#THIS MUST BE AT THE END OF THE FILE FOR SDKMAN TO WORK!!!
export SDKMAN_DIR="$HOME/.sdkman"
if [ ! -f $SDKMAN_DIR/bin/sdkman-init.sh ]; then
   curl -s "https://get.sdkman.io" | bash
   echo "!!!!! ATTENTION !!!!!"
   echo "The sdkman installation adds some reduntant code at .bashrc and .zsh files. Remove this snippets"
fi
[[ -s "$SDKMAN_DIR/bin/sdkman-init.sh" ]] && source "$SDKMAN_DIR/bin/sdkman-init.sh"

#
export NVM_DIR="$HOME/.nvm"
if [ ! -f $NVM_DIR/nvm.sh ]; then
    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
    echo "!!!!! ATTENTION !!!!!"
    echo "The nvm installation adds some reduntant code at .bashrc and .zsh files. Remove this snippets"
fi
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion
